<html>
<head>
<title>Python Code Quality </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Pythonä»£ç è´¨é‡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://testdriven.io/blog/python-code-quality/#0001-01-01">https://testdriven.io/blog/python-code-quality/#0001-01-01</a></blockquote><div><div class="blog-content long-content" data-local-nav-source="">
    <p><em>åˆ°åº•ä»€ä¹ˆæ˜¯ä»£ç è´¨é‡ï¼Ÿæˆ‘ä»¬å¦‚ä½•è¡¡é‡å®ƒï¼Ÿæˆ‘ä»¬å¦‚ä½•æé«˜ä»£ç è´¨é‡ï¼Œæ¸…ç†æˆ‘ä»¬çš„Pythonä»£ç ï¼Ÿ</em></p>
<p><br/></p>
<p><a href="https://en.wikipedia.org/wiki/Software_quality">ä»£ç è´¨é‡</a>ä¸€èˆ¬æŒ‡ä½ çš„ä»£ç åŠŸèƒ½æ€§å’Œå¯ç»´æŠ¤æ€§å¦‚ä½•ã€‚åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ï¼Œä»£ç è¢«è§†ä¸ºé«˜è´¨é‡:</p>
<ol>
<li>è¿™ç¬¦åˆå®ƒçš„ç›®çš„</li>
<li>å®ƒçš„è¡Œä¸ºæ˜¯å¯ä»¥æµ‹è¯•çš„</li>
<li>å®ƒéµå¾ªä¸€è´¯çš„é£æ ¼</li>
<li>å¯ä»¥ç†è§£</li>
<li>å®ƒä¸åŒ…å«å®‰å…¨æ¼æ´</li>
<li>è¿™æ˜¯æœ‰æ®å¯æŸ¥çš„</li>
<li>å¾ˆå®¹æ˜“ç»´æŠ¤</li>
</ol>
<p>å› ä¸ºæˆ‘ä»¬å·²ç»åœ¨Pythonä¸­çš„<a href="/blog/testing-python/">æµ‹è¯•</a>å’ŒPythonä¸­çš„<a href="/blog/modern-tdd/">ç°ä»£æµ‹è¯•é©±åŠ¨å¼€å‘</a>æ–‡ç« ä¸­è§£å†³äº†å‰ä¸¤ç‚¹ï¼Œæ‰€ä»¥æœ¬æ–‡çš„é‡ç‚¹æ˜¯ç¬¬ä¸‰è‡³ç¬¬ä¸ƒç‚¹ã€‚</p>
<p>æœ¬æ–‡æ¢è®¨äº†å¦‚ä½•ä½¿ç”¨lintersã€ä»£ç æ ¼å¼åŒ–å™¨å’Œå®‰å…¨æ¼æ´æ‰«æå™¨æ¥æé«˜Pythonä»£ç çš„è´¨é‡ã€‚</p>
<p><br/></p>
<blockquote>
<p><a href="/guides/complete-python/">å®Œæ•´Python </a>æŒ‡å—:</p>
<ol>
<li><a href="/blog/python-environments/">ç°ä»£Pythonç¯å¢ƒâ€”â€”ä¾èµ–æ€§å’Œå·¥ä½œç©ºé—´ç®¡ç†</a></li>
<li><a href="/blog/testing-python/">Pythonä¸­çš„æµ‹è¯•</a></li>
<li><a href="/blog/modern-tdd/">Pythonä¸­çš„ç°ä»£æµ‹è¯•é©±åŠ¨å¼€å‘</a></li>
<li><a href="/blog/python-code-quality/"> Pythonä»£ç è´¨é‡</a>(æœ¬æ–‡ï¼)</li>
<li><a href="/blog/python-type-checking/"> Pythonç±»å‹æ£€æŸ¥</a></li>
<li><a href="/blog/documenting-python/">è®°å½•Pythonä»£ç å’Œé¡¹ç›®</a></li>
<li><a href="/blog/python-project-workflow/"> Pythoné¡¹ç›®å·¥ä½œæµç¨‹</a></li>
</ol>
</blockquote>



<h2 id="linters">æ£‰çŸ­ç»’</h2>
<p><a href="https://en.wikipedia.org/wiki/Lint_(software)"> Linters </a>é€šè¿‡æºä»£ç åˆ†ææ ‡è®°ç¼–ç¨‹é”™è¯¯ã€bugã€é£æ ¼é”™è¯¯å’Œå¯ç–‘ç»“æ„ã€‚æ—æŒºå·¥å…·æ˜“äºè®¾ç½®ï¼Œæä¾›åˆç†çš„é»˜è®¤å€¼ï¼Œå¹¶é€šè¿‡æ¶ˆé™¤å¯¹é£æ ¼æœ‰ä¸åŒæ„è§çš„å¼€å‘äººå‘˜ä¹‹é—´çš„æ‘©æ“¦æ¥æ”¹å–„æ•´ä½“å¼€å‘ä½“éªŒã€‚</p>
<blockquote>
<p>è™½ç„¶æ—æŒºæ˜¯ä¸€ç§å¸¸è§çš„å®è·µï¼Œä½†å®ƒä»ç„¶è¢«è®¸å¤šå¼€å‘äººå‘˜æ‰€ä¸å–œæ¬¢ï¼Œå› ä¸ºå¼€å‘äººå‘˜å¾€å¾€éå¸¸å›ºæ‰§å·±è§ã€‚</p>
</blockquote>
<p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<p>ç‰ˆæœ¬ä¸€:</p>
<div class="codehilite"><pre><span/><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'Enter a number: '</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">answer</span> <span class="o">!=</span> <span class="s1">'quit'</span><span class="p">:</span>
        <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Numbers: </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">numbers</span><span class="p">)</span>
</code></pre></div>

<p>ç‰ˆæœ¬äºŒ:</p>
<div class="codehilite"><pre><span/><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">while</span> <span class="p">(</span><span class="n">answer</span> <span class="o">:=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"Enter a number: "</span><span class="p">))</span> <span class="o">!=</span> <span class="s2">"quit"</span><span class="p">:</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Numbers: </span><span class="si">{</span><span class="n">numbers</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>

<p>ç‰ˆæœ¬ä¸‰:</p>
<div class="codehilite"><pre><span/><code><span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">answer</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">"Enter a number: "</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="s2">"quit"</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Numbers: </span><span class="si">{</span><span class="n">numbers</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>

<p>å“ªä¸ªæ›´å¥½ï¼Ÿ</p>
<p>å°±åŠŸèƒ½è€Œè¨€ï¼Œå®ƒä»¬æ˜¯ç›¸åŒçš„ã€‚</p>
<p>ä½ å–œæ¬¢å“ªä¸€ä¸ªï¼Ÿä½ çš„é¡¹ç›®åˆä½œè€…æ›´å–œæ¬¢å“ªä¸€ä¸ªï¼Ÿ</p>
<p>ä½œä¸ºä¸€åè½¯ä»¶å¼€å‘äººå‘˜ï¼Œä½ å¾ˆå¯èƒ½åœ¨å›¢é˜Ÿä¸­å·¥ä½œã€‚è€Œä¸”ï¼Œåœ¨å›¢é˜Ÿç¯å¢ƒä¸­ï¼Œæ‰€æœ‰å¼€å‘äººå‘˜éµå¾ªç›¸åŒçš„ç¼–ç æ ‡å‡†æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸ç„¶çœ‹åˆ«äººçš„ä»£ç å°±éš¾å¤šäº†ã€‚ä»£ç å®¡æŸ¥çš„é‡ç‚¹åº”è¯¥æ˜¯æ›´é«˜å±‚æ¬¡çš„é—®é¢˜ï¼Œè€Œä¸æ˜¯æ™®é€šçš„è¯­æ³•æ ¼å¼é—®é¢˜ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ å†³å®šç”¨æ„Ÿå¹å·ç»“æŸæ¯ä¸€å¥è¯ï¼Œè¯»è€…å°†å¾ˆéš¾æ¨æ–­å‡ºè¯­æ°”ã€‚å¦‚æœä½ æ›´è¿›ä¸€æ­¥ï¼Œå¿½ç•¥åƒå¤§å†™å’Œé—´è·è§„åˆ™è¿™æ ·çš„é€šç”¨æ ‡å‡†ï¼Œä½ çš„å¥å­å°†å¾ˆéš¾é˜…è¯»ã€‚é˜…è¯»ä½ çš„ä½œå“éœ€è¦æ›´å¤šçš„è„‘åŠ›ã€‚ä½ ä¼šå¤±å»è¯»è€…å’Œåˆä½œè€…ã€‚ä»£ç ä¹Ÿç±»ä¼¼ã€‚æˆ‘ä»¬ä½¿ç”¨é£æ ¼æŒ‡å—ä½¿æˆ‘ä»¬çš„å¼€å‘ä¼™ä¼´(åŒ…æ‹¬æˆ‘ä»¬è‡ªå·±)æ›´å®¹æ˜“æ¨æ–­æ„å›¾å¹¶ä¸æˆ‘ä»¬åˆä½œã€‚</p>
<p>ä½œä¸ºPythonå¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬å¾ˆå¹¸è¿èƒ½å¤Ÿæ‹¥æœ‰<a href="https://pep8.org/"> PEP-8 </a>é£æ ¼æŒ‡å—ï¼Œå®ƒæä¾›äº†ä¸€ç»„çº¦å®šã€æŒ‡å—å’Œæœ€ä½³å®è·µï¼Œä½¿æˆ‘ä»¬çš„ä»£ç æ›´å®¹æ˜“é˜…è¯»å’Œç»´æŠ¤ã€‚å®ƒä¸»è¦å…³æ³¨å‘½åçº¦å®šã€ä»£ç æ³¨é‡Šå’Œå¸ƒå±€é—®é¢˜(æ¯”å¦‚ç¼©è¿›å’Œç©ºç™½)ã€‚å‡ ä¸ªä¾‹å­:</p>

<p>å°±æ—æŒºå·¥å…·è€Œè¨€ï¼Œè™½ç„¶æœ‰å¾ˆå¤šè¿™æ ·çš„å·¥å…·ï¼Œä½†å¤§éƒ¨åˆ†éƒ½æ˜¯åœ¨ä»£ç é€»è¾‘æˆ–å¼ºåˆ¶ä»£ç æ ‡å‡†ä¸­å¯»æ‰¾é”™è¯¯:</p>
<ol>
<li><strong>ä»£ç é€»è¾‘</strong>â€”â€”è¿™äº›æ£€æŸ¥ç¼–ç¨‹é”™è¯¯ï¼Œå¼ºåˆ¶æ‰§è¡Œä»£ç æ ‡å‡†ï¼Œæœç´¢ä»£ç æ°”å‘³ï¼Œå¹¶æ£€æŸ¥ä»£ç å¤æ‚æ€§ã€‚<a href="https://github.com/PyCQA/pyflakes"> Pyflakes </a>å’Œ<a href="https://github.com/PyCQA/mccabe"> McCabe </a>(å¤æ‚åº¦æ£€æŸ¥å™¨)æ˜¯æ—æŒºä»£ç é€»è¾‘æœ€æµè¡Œçš„å·¥å…·ã€‚</li>
<li><strong>ä»£ç é£æ ¼</strong>â€”â€”è¿™äº›åªæ˜¯æ‰§è¡Œä»£ç æ ‡å‡†(åŸºäºPEP-8)ã€‚<a href="https://github.com/pycqa/pycodestyle"> pycodestyle </a>å°±å±äºè¿™ä¸€ç±»ã€‚</li>
</ol>
<h3 id="flake8">è–„ç‰‡8</h3>
<p><a href="https://flake8.pycqa.org/"> Flake8 </a>æ˜¯Pyflakesã€pycodestyleå’ŒMcCabeçš„åŒ…è£…å™¨ã€‚</p>
<p>å®ƒå¯ä»¥åƒä»»ä½•å…¶ä»–PyPIåŒ…ä¸€æ ·å®‰è£…:</p>


<p>å‡è®¾æ‚¨å°†ä»¥ä¸‹ä»£ç ä¿å­˜åˆ°ä¸€ä¸ªåä¸º<em> my_module.py </em>çš„æ–‡ä»¶ä¸­:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">get_error_message</span><span class="p">(</span><span class="n">error_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'red'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'orange'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'yellow'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'blue'</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s1">'https://api.github.com/events'</span><span class="p">)</span>
    <span class="n">STATUS</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">STATUS</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">get_error_message</span><span class="p">(</span><span class="n">STATUS</span><span class="p">))</span>




<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>è¦lintè¿™ä¸ªæ–‡ä»¶ï¼Œæ‚¨åªéœ€è¿è¡Œ:</p>
<div class="codehilite"><pre><span/><code>$ python -m flake8 my_module.py
</code></pre></div>

<p>è¿™å°†äº§ç”Ÿä»¥ä¸‹è¾“å‡º:</p>
<div class="codehilite"><pre><span/><code>my_module.py:1:1: F403 <span class="s1">'from requests import *'</span> used<span class="p">;</span> unable to detect undefined names
my_module.py:3:1: E302 expected <span class="m">2</span> blank lines, found <span class="m">1</span>
my_module.py:15:11: F405 <span class="s1">'get'</span> may be undefined, or defined from star imports: requests
my_module.py:25:1: E303 too many blank lines <span class="o">(</span><span class="m">4</span><span class="o">)</span>
</code></pre></div>

<blockquote>
<p>æ ¹æ®ä»£ç ç¼–è¾‘å™¨çš„é…ç½®ï¼Œæ‚¨å¯èƒ½è¿˜ä¼šçœ‹åˆ°ä¸€ä¸ª<code>my_module.py:26:11: W292 no newline at end of file</code>é”™è¯¯ã€‚</p>
</blockquote>
<p>å¯¹äºæ¯ä¸ªè¿è§„ï¼Œéƒ½ä¼šæ‰“å°ä¸€è¡Œï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹æ•°æ®:</p>
<ol>
<li>æ–‡ä»¶è·¯å¾„(ç›¸å¯¹äºè¿è¡ŒFlake8çš„ç›®å½•)</li>
<li>è¡Œæ•°</li>
<li>åˆ—å·</li>
<li>è¿åçš„<a href="https://www.flake8rules.com/">è§„åˆ™çš„ID</a></li>
<li>è§„åˆ™æè¿°</li>
</ol>
<p>ä»¥<code>F</code>å¼€å¤´çš„è¿ä¾‹æ˜¯æ¥è‡ª<a href="https://flake8.pycqa.org/en/latest/user/error-codes.html"> Pyflakes </a>çš„é”™è¯¯ï¼Œè€Œä»¥<code>E</code>å¼€å¤´çš„è¿ä¾‹æ¥è‡ª<a href="https://pycodestyle.pycqa.org/en/latest/intro.html#error-codes"> pycodestyle </a>ã€‚</p>
<p>çº æ­£è¿è§„åï¼Œæ‚¨åº”è¯¥:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span>


<span class="k">def</span> <span class="nf">get_error_message</span><span class="p">(</span><span class="n">error_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'red'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'orange'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'yellow'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'blue'</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s1">'https://api.github.com/events'</span><span class="p">)</span>
    <span class="n">STATUS</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">STATUS</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">get_error_message</span><span class="p">(</span><span class="n">STATUS</span><span class="p">))</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>

<p>é™¤äº†PyFlakeså’Œpycodestyleï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨Flake8æ¥æ£€æŸ¥<a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity">åœˆå¤æ‚åº¦</a>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ<code>get_error_message</code>å‡½æ•°çš„å¤æ‚åº¦ä¸º4ï¼Œå› ä¸ºæœ‰å››ä¸ªå¯èƒ½çš„åˆ†æ”¯(æˆ–ä»£ç è·¯å¾„):</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_error_message</span><span class="p">(</span><span class="n">error_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">404</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'red'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'orange'</span>
    <span class="k">elif</span> <span class="n">error_type</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'yellow'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'blue'</span>
</code></pre></div>

<p>è¦å¼ºåˆ¶æœ€å¤§å¤æ‚æ€§ä¸º3æˆ–æ›´ä½ï¼Œè¯·è¿è¡Œ:</p>
<div class="codehilite"><pre><span/><code>$ python -m flake8 --max-complexity <span class="m">3</span> my_module.py
</code></pre></div>

<p>Flake8åº”å¤±è´¥ï¼Œå‡ºç°ä»¥ä¸‹æƒ…å†µ:</p>
<div class="codehilite"><pre><span/><code>my_module.py:4:1: C901 <span class="s1">'get_error_message'</span> is too complex <span class="o">(</span><span class="m">4</span><span class="o">)</span>
</code></pre></div>

<p>åƒè¿™æ ·é‡æ„ä»£ç :</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">get_error_message</span><span class="p">(</span><span class="n">error_type</span><span class="p">):</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">404</span><span class="p">:</span> <span class="s1">'red'</span><span class="p">,</span>
        <span class="mi">403</span><span class="p">:</span> <span class="s1">'orange'</span><span class="p">,</span>
        <span class="mi">401</span><span class="p">:</span> <span class="s1">'yellow'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">colors</span><span class="p">[</span><span class="n">error_type</span><span class="p">]</span> <span class="k">if</span> <span class="n">error_type</span> <span class="ow">in</span> <span class="n">colors</span> <span class="k">else</span> <span class="s1">'blue'</span>
</code></pre></div>

<p>è–„ç‰‡8ç°åœ¨åº”è¯¥é€šè¿‡:</p>
<div class="codehilite"><pre><span/><code>$ python -m flake8 --max-complexity <span class="m">3</span> my_module.py
</code></pre></div>

<p>ä½ å¯ä»¥é€šè¿‡å®ƒå¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿç»™Flake8æ·»åŠ é¢å¤–çš„æ£€æŸ¥ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å®æ–½PEP-8å‘½åçº¦å®šï¼Œå®‰è£…<a href="https://github.com/PyCQA/pep8-naming"> pep8-naming </a>:</p>
<div class="codehilite"><pre><span/><code>$ pip install pep8-naming
</code></pre></div>

<p>è¿è¡Œ:</p>
<div class="codehilite"><pre><span/><code>$ python -m flake8 my_module.py
</code></pre></div>

<p>æ‚¨åº”è¯¥çœ‹åˆ°:</p>
<div class="codehilite"><pre><span/><code>my_module.py:15:6: N806 variable <span class="s1">'STATUS'</span> <span class="k">in</span> <span class="k">function</span> should be lowercase
</code></pre></div>

<p>ä¿®å¤:</p>
<div class="codehilite"><pre><span/><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s1">'https://api.github.com/events'</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">status_code</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">get_error_message</span><span class="p">(</span><span class="n">status</span><span class="p">))</span>
</code></pre></div>

<p>æŸ¥çœ‹<a href="https://github.com/DmytroLitvinov/awesome-flake8-extensions">ç‰›é€¼çš„Flake8æ‰©å±•</a>è·å¾—æœ€å—æ¬¢è¿çš„æ‰©å±•åˆ—è¡¨ã€‚</p>
<blockquote>
<p>Pylama ä¹Ÿæ˜¯ä¸€ç§æµè¡Œçš„æ—æŒºå·¥å…·ï¼ŒåƒFlake8ä¸€æ ·ï¼Œå®ƒå¯ä»¥å°†å‡ å—æ£‰ç»’ç²˜åˆåœ¨ä¸€èµ·ã€‚</p>
</blockquote>
<h2 id="code-formatters">ä»£ç æ ¼å¼åŒ–ç¨‹åº</h2>
<p>è™½ç„¶lintersåªæ˜¯æ£€æŸ¥ä»£ç ä¸­çš„é—®é¢˜ï¼Œä½†ä»£ç æ ¼å¼åŒ–ç¨‹åºå®é™…ä¸Šæ˜¯åŸºäºä¸€ç»„æ ‡å‡†æ¥é‡æ–°æ ¼å¼åŒ–ä»£ç çš„ã€‚</p>
<p>è®©ä½ çš„ä»£ç ä¿æŒæ­£ç¡®çš„æ ¼å¼æ˜¯ä¸€é¡¹å¿…è¦è€Œæ¯ç‡¥çš„å·¥ä½œï¼Œåº”è¯¥ç”±è®¡ç®—æœºæ¥å®Œæˆã€‚</p>
<p>ä¸ºä»€ä¹ˆæœ‰å¿…è¦ï¼Ÿ</p>
<p>éµå¾ªä¸€è‡´æ€§é£æ ¼æŒ‡å—çš„æ ¼å¼è‰¯å¥½çš„ä»£ç æ›´å®¹æ˜“é˜…è¯»ï¼Œè¿™ä½¿å¾—æ‰¾åˆ°bugå’Œæ–°å¼€å‘äººå‘˜æ›´å®¹æ˜“ã€‚å®ƒè¿˜å‡å°‘äº†åˆå¹¶å†²çªã€‚</p>
<blockquote>
<p>å¯è¯»æ€§å¾ˆé‡è¦ã€‚</p>
<p>â€“Pythonçš„<a href="https://en.wikipedia.org/wiki/Zen_of_Python">ç¦…</a></p>
</blockquote>
<p>åŒæ ·ï¼Œå› ä¸ºè¿™æ˜¯ä¸€é¡¹æ¯ç‡¥çš„å·¥ä½œï¼Œå¼€å‘äººå‘˜å¸¸å¸¸å›ºæ‰§å·±è§(åˆ¶è¡¨ç¬¦å¯¹ç©ºæ ¼ï¼Œå•å¼•å·å¯¹åŒå¼•å·ï¼Œç­‰ç­‰)ã€‚)ï¼Œä½¿ç”¨ä»£ç æ ¼å¼åŒ–å·¥å…·æ ¹æ®ä¸€ç»„æ ‡å‡†è‡ªåŠ¨é‡æ–°æ ¼å¼åŒ–æ‚¨çš„ä»£ç ã€‚</p>
<h3 id="isort">ä¼Šç´¢ç‰¹</h3>
<p><a href="https://pycqa.github.io/isort/"> isort </a>ç”¨äºè‡ªåŠ¨å°†ä»£ç ä¸­çš„å¯¼å…¥åˆ†æˆä»¥ä¸‹å‡ ç»„:</p>
<ol>
<li>æ ‡å‡†ç¨‹åºåº“</li>
<li>ç¬¬ä¸‰æ–¹çš„</li>
<li>å½“åœ°çš„</li>
</ol>
<p>ç„¶åï¼Œæˆç»„çš„å¯¼å…¥æŒ‰å­—æ¯é¡ºåºé€ä¸ªæ’åˆ—ã€‚</p>
<div class="codehilite"><pre><span/><code><span class="c1"># standard library</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># third-party</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask.cli</span> <span class="kn">import</span> <span class="n">AppGroup</span>

<span class="c1"># local</span>
<span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">some_method</span>
</code></pre></div>

<p>å®‰è£…:</p>


<blockquote>
<p>å¦‚æœä½ æ›´å–œæ¬¢Flake8æ’ä»¶ï¼Œè¯·æŸ¥çœ‹<a href="https://github.com/gforcada/flake8-isort"> flake8-isort </a>ã€‚<a href="https://github.com/PyCQA/flake8-import-order">è–„ç‰‡8-è¿›å£è®¢å•</a>ä¹Ÿå¾ˆå—æ¬¢è¿ã€‚</p>
</blockquote>
<p>å¯¹å½“å‰ç›®å½•å’Œå­ç›®å½•ä¸­çš„æ–‡ä»¶è¿è¡Œå®ƒ:</p>


<p>è¦å¯¹å•ä¸ªæ–‡ä»¶è¿è¡Œå®ƒ:</p>
<div class="codehilite"><pre><span/><code>$ python -m isort my_module.py
</code></pre></div>

<p>ä¹‹å‰:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">some_method</span>
<span class="kn">from</span> <span class="nn">flask.cli</span> <span class="kn">import</span> <span class="n">AppGroup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
</code></pre></div>

<p>ä¹‹å:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask.cli</span> <span class="kn">import</span> <span class="n">AppGroup</span>

<span class="kn">from</span> <span class="nn">your_module</span> <span class="kn">import</span> <span class="n">some_method</span>
</code></pre></div>

<p>è¦æ£€æŸ¥æ‚¨çš„å¯¼å…¥æ˜¯å¦æ­£ç¡®æ’åºï¼Œå¹¶ä¸”ä¸åšä»»ä½•æ›´æ”¹ï¼Œè¯·ä½¿ç”¨<code>--check-only</code>æ ‡å¿—:</p>
<div class="codehilite"><pre><span/><code>$ python -m isort my_module.py --check-only

ERROR: my_module.py Imports are incorrectly sorted and/or formatted.
</code></pre></div>

<p>è¦æŸ¥çœ‹æ›´æ”¹ï¼Œè€Œä¸åº”ç”¨æ›´æ”¹ï¼Œè¯·ä½¿ç”¨<code>--diff</code>æ ‡å¿—:</p>
<div class="codehilite"><pre><span/><code>$ python -m isort my_module.py --diff

--- my_module.py:before      <span class="m">2022</span>-02-28 <span class="m">22</span>:04:45.977272
+++ my_module.py:after       <span class="m">2022</span>-02-28 <span class="m">22</span>:04:48.254686
@@ -1,6 +1,7 @@
+import datetime
 import os
-import datetime
+
+import requests
+from flask import Flask
+from flask.cli import AppGroup
 from your_module import some_method
-from flask.cli import AppGroup
-import requests
-from flask import Flask
</code></pre></div>

<p>ä½¿ç”¨isortå’ŒBlackæ—¶ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨<code>--profile black</code> <a href="https://pycqa.github.io/isort/docs/configuration/black_compatibility.html">é€‰é¡¹</a>,ä»¥é¿å…ä»£ç é£æ ¼å†²çª:</p>
<div class="codehilite"><pre><span/><code>$ python -m isort --profile black .
</code></pre></div>

<h3 id="black">é»‘è‰²</h3>
<p><a href="https://github.com/psf/black"> Black </a>æ˜¯ä¸€ä¸ªPythonä»£ç æ ¼å¼åŒ–ç¨‹åºï¼Œç”¨äºæ ¹æ®Blackçš„<a href="https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html">ä»£ç é£æ ¼æŒ‡å—</a>é‡æ–°æ ¼å¼åŒ–ä½ çš„ä»£ç ï¼Œå®ƒéå¸¸æ¥è¿‘PEP-8ã€‚</p>


<blockquote>
<p>æ›´å–œæ¬¢Flake8æ’ä»¶ï¼Ÿæ£€æŸ¥ä¸€ä¸‹<a href="https://github.com/peterjc/flake8-black"> flake8-black </a>ã€‚</p>
</blockquote>
<p>è¦é€’å½’ç¼–è¾‘å½“å‰ç›®å½•ä¸­çš„æ–‡ä»¶:</p>


<p>å®ƒä¹Ÿå¯ä»¥é’ˆå¯¹å•ä¸ªæ–‡ä»¶è¿è¡Œ:</p>
<div class="codehilite"><pre><span/><code>$ python -m black my_module.py
</code></pre></div>

<p>ä¹‹å‰:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">pytest</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"module"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">authenticated_client</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">"/login"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8febfae2e2f6cfeae2eee6e3a1eee6">[emailÂ protected]</a>"</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">"notreal"</span><span class="p">),</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</code></pre></div>

<p>ä¹‹å:</p>
<div class="codehilite"><pre><span/><code><span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">"module"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">authenticated_client</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
    <span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="s2">"/login"</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f3b2a3232261f3a323e3633713e36">[emailÂ protected]</a>"</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">"notreal"</span><span class="p">),</span>
        <span class="n">follow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">client</span>
</code></pre></div>

<p>å¦‚æœæ‚¨åªæƒ³æ£€æŸ¥æ‚¨çš„ä»£ç æ˜¯å¦éµå¾ªBlack codeé£æ ¼æ ‡å‡†ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>--check</code>æ ‡å¿—:</p>
<div class="codehilite"><pre><span/><code>$ python -m black my_module.py --check

would reformat my_module.py
Oh no! ğŸ’¥ ğŸ’” ğŸ’¥
<span class="m">1</span> file would be reformatted.
</code></pre></div>

<p>ä¸æ­¤åŒæ—¶,<code>--diff</code>æ ‡å¿—æ˜¾ç¤ºäº†å½“å‰ä»£ç å’Œé‡æ–°æ ¼å¼åŒ–åçš„ä»£ç ä¹‹é—´çš„å·®å¼‚:</p>
<div class="codehilite"><pre><span/><code>$ python -m black my_module.py --diff

--- my_module.py        <span class="m">2022</span>-02-28 <span class="m">22</span>:04:45.977272 +0000
+++ my_module.py        <span class="m">2022</span>-02-28 <span class="m">22</span>:05:15.124565 +0000
@@ -1,7 +1,12 @@
 import pytest
+

 @pytest.fixture<span class="o">(</span><span class="nv">scope</span><span class="o">=</span><span class="s2">"module"</span><span class="o">)</span>
 def authenticated_client<span class="o">(</span>app<span class="o">)</span>:
     <span class="nv">client</span> <span class="o">=</span> app.test_client<span class="o">()</span>
-    client.post<span class="o">(</span><span class="s2">"/login"</span>, <span class="nv">data</span><span class="o">=</span>dict<span class="o">(</span><span class="nv">email</span><span class="o">=</span><span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9ffbeaf2f2e6dffaf2fef6f3b1fef6">[emailÂ protected]</a>"</span>, <span class="nv">password</span><span class="o">=</span><span class="s2">"notreal"</span><span class="o">)</span>, <span class="nv">follow_redirects</span><span class="o">=</span>True<span class="o">)</span>
-    <span class="k">return</span> client
<span class="se">\ </span>No newline at end of file
+    client.post<span class="o">(</span>
+        <span class="s2">"/login"</span>,
+        <span class="nv">data</span><span class="o">=</span>dict<span class="o">(</span><span class="nv">email</span><span class="o">=</span><span class="s2">"<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5f3b2a3232261f3a323e3633713e36">[emailÂ protected]</a>"</span>, <span class="nv">password</span><span class="o">=</span><span class="s2">"notreal"</span><span class="o">)</span>,
+        <span class="nv">follow_redirects</span><span class="o">=</span>True,
+    <span class="o">)</span>
+    <span class="k">return</span> client
would reformat my_module.py

All <span class="k">done</span>! âœ¨ ğŸ° âœ¨
<span class="m">1</span> file would be reformatted.
</code></pre></div>

<blockquote>
<p><a href="https://github.com/google/yapf"> YAPF </a>å’Œ<a href="https://github.com/hhatto/autopep8"> autopep8 </a>æ˜¯ç±»ä¼¼äºBlackçš„ä»£ç æ ¼å¼åŒ–ç¨‹åºï¼Œä¹Ÿå€¼å¾—ä¸€çœ‹ã€‚</p>
</blockquote>
<h2 id="security-vulnerability-scanners">å®‰å…¨æ¼æ´æ‰«æå™¨</h2>
<p>å®‰å…¨æ¼æ´å¯ä»¥è¯´æ˜¯ä»£ç è´¨é‡æœ€é‡è¦çš„æ–¹é¢ï¼Œç„¶è€Œå®ƒä»¬ç»å¸¸è¢«å¿½è§†ã€‚æ‚¨çš„ä»£ç çš„å®‰å…¨æ€§å–å†³äºå®ƒæœ€è–„å¼±çš„ç¯èŠ‚ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰è®¸å¤šå·¥å…·å¯ä»¥å¸®åŠ©æ£€æµ‹æˆ‘ä»¬ä»£ç ä¸­å¯èƒ½çš„æ¼æ´ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸­çš„ä¸¤ä¸ªã€‚</p>
<h3 id="bandit">å¼ºç›—</h3>
<p><a href="https://github.com/PyCQA/bandit"> Bandit </a>æ˜¯ä¸€æ¬¾æ—¨åœ¨å‘ç°Pythonä»£ç ä¸­å¸¸è§å®‰å…¨<a href="https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing">é—®é¢˜</a>çš„å·¥å…·ï¼Œæ¯”å¦‚ç¡¬ç¼–ç çš„å¯†ç å­—ç¬¦ä¸²ã€ååºåˆ—åŒ–ä¸å¯ä¿¡ä»£ç ã€åœ¨exceptå—ä¸­ä½¿ç”¨<code>pass</code>ç­‰ç­‰ã€‚</p>


<blockquote>
<p>æ›´å–œæ¬¢Flake8æ’ä»¶ï¼Ÿæ£€æŸ¥ä¸€ä¸‹<a href="https://github.com/tylerwince/flake8-bandit"> flake8-bandit </a>ã€‚</p>
</blockquote>
<p>åƒè¿™æ ·è¿è¡Œå®ƒ:</p>


<p>ä»£ç :</p>
<div class="codehilite"><pre><span/><code><span class="n">evaluate</span> <span class="o">=</span> <span class="s1">'print("Hi!")'</span>
<span class="nb">eval</span><span class="p">(</span><span class="n">evaluate</span><span class="p">)</span>


<span class="n">evaluate</span> <span class="o">=</span> <span class="s1">'open("secret_file.txt").read()'</span>
<span class="nb">eval</span><span class="p">(</span><span class="n">evaluate</span><span class="p">)</span>
</code></pre></div>

<p>æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ä»¥ä¸‹è­¦å‘Š:</p>
<div class="codehilite"><pre><span/><code>&gt;&gt; Issue: <span class="o">[</span>B307:blacklist<span class="o">]</span> Use of possibly insecure <span class="k">function</span> - consider using safer
    ast.literal_eval.
   Severity: Medium   Confidence: High
   Location: my_module.py:2
   More Info:
    https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval
<span class="m">1</span>   <span class="nv">evaluate</span> <span class="o">=</span> <span class="s1">'print("Hi!")'</span>
<span class="m">2</span>   eval<span class="o">(</span>evaluate<span class="o">)</span>
<span class="m">3</span>

--------------------------------------------------
&gt;&gt; Issue: <span class="o">[</span>B307:blacklist<span class="o">]</span> Use of possibly insecure <span class="k">function</span> - consider using safer
    ast.literal_eval.
   Severity: Medium   Confidence: High
   Location: my_module.py:6
   More Info:
    https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b307-eval
<span class="m">5</span>   <span class="nv">evaluate</span> <span class="o">=</span> <span class="s1">'open("secret_file.txt").read()'</span>
<span class="m">6</span>   eval<span class="o">(</span>evaluate<span class="o">)</span>

--------------------------------------------------
</code></pre></div>

<h3 id="safety">å®‰å…¨</h3>
<p>å®‰å…¨æ˜¯å¦ä¸€ä¸ªè®©ä½ çš„ä»£ç å…äºå®‰å…¨é—®é¢˜çš„å·¥å…·ã€‚</p>
<p>å®ƒç”¨äºå¯¹ç…§<a href="https://github.com/pyupio/safety-db">å®‰å…¨æ•°æ®åº“</a>æ£€æŸ¥æ‚¨å·²å®‰è£…çš„ä¾èµ–é¡¹ä¸­å·²çŸ¥çš„å®‰å…¨æ¼æ´ï¼Œå®‰å…¨æ•°æ®åº“æ˜¯PythonåŒ…ä¸­å·²çŸ¥å®‰å…¨æ¼æ´çš„æ•°æ®åº“ã€‚</p>


<p>æ¿€æ´»è™šæ‹Ÿç¯å¢ƒåï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·è¿è¡Œå®ƒ:</p>


<p>å®‰è£…çƒ§ç“¶v0.12.2æ—¶çš„æ ·å“è¾“å‡º:</p>
<div class="codehilite"><pre><span/><code>+<span class="o">==============================================================================</span>+
<span class="p">|</span>                                                                              <span class="p">|</span>
<span class="p">|</span>                               /<span class="nv">$$$$$$</span>            /<span class="nv">$$</span>                         <span class="p">|</span>
<span class="p">|</span>                              /<span class="nv">$$</span>__  <span class="nv">$$</span>          <span class="p">|</span> <span class="nv">$$</span>                         <span class="p">|</span>
<span class="p">|</span>           /<span class="nv">$$$$$$</span>$  /<span class="nv">$$$$$$</span> <span class="p">|</span> <span class="nv">$$</span>  <span class="se">\_</span>_//<span class="nv">$$$$$$</span>  /<span class="nv">$$$$$$</span>   /<span class="nv">$$</span>   /<span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>          /<span class="nv">$$</span>_____/ <span class="p">|</span>____  <span class="nv">$$</span><span class="p">|</span> <span class="nv">$$$$</span>   /<span class="nv">$$</span>__  <span class="nv">$$</span><span class="p">|</span>_  <span class="nv">$$</span>_/  <span class="p">|</span> <span class="nv">$$</span>  <span class="p">|</span> <span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>         <span class="p">|</span>  <span class="nv">$$$$$$</span>   /<span class="nv">$$$$$$</span>$<span class="p">|</span> <span class="nv">$$</span>_/  <span class="p">|</span> <span class="nv">$$$$$$$$</span>  <span class="p">|</span> <span class="nv">$$</span>    <span class="p">|</span> <span class="nv">$$</span>  <span class="p">|</span> <span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>          <span class="se">\_</span>___  <span class="nv">$$</span> /<span class="nv">$$</span>__  <span class="nv">$$</span><span class="p">|</span> <span class="nv">$$</span>    <span class="p">|</span> <span class="nv">$$</span>_____/  <span class="p">|</span> <span class="nv">$$</span> /<span class="nv">$$</span><span class="p">|</span> <span class="nv">$$</span>  <span class="p">|</span> <span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>          /<span class="nv">$$$$$$</span>$/<span class="p">|</span>  <span class="nv">$$$$$$</span>$<span class="p">|</span> <span class="nv">$$</span>    <span class="p">|</span>  <span class="nv">$$$$$$</span>$  <span class="p">|</span>  <span class="nv">$$$$</span>/<span class="p">|</span>  <span class="nv">$$$$$$</span>$           <span class="p">|</span>
<span class="p">|</span>         <span class="p">|</span>_______/  <span class="se">\_</span>______/<span class="p">|</span>__/     <span class="se">\_</span>______/   <span class="se">\_</span>__/   <span class="se">\_</span>___  <span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>                                                          /<span class="nv">$$</span>  <span class="p">|</span> <span class="nv">$$</span>           <span class="p">|</span>
<span class="p">|</span>                                                         <span class="p">|</span>  <span class="nv">$$$$$$</span>/           <span class="p">|</span>
<span class="p">|</span>  by pyup.io                                              <span class="se">\_</span>_____/            <span class="p">|</span>
<span class="p">|</span>                                                                              <span class="p">|</span>
+<span class="o">==============================================================================</span>+
<span class="p">|</span> REPORT                                                                       <span class="p">|</span>
<span class="p">|</span> checked <span class="m">37</span> packages, using default DB                                        <span class="p">|</span>
+<span class="o">============================</span>+<span class="o">===========</span>+<span class="o">==========================</span>+<span class="o">==========</span>+
<span class="p">|</span> package                    <span class="p">|</span> installed <span class="p">|</span> affected                 <span class="p">|</span> ID       <span class="p">|</span>
+<span class="o">============================</span>+<span class="o">===========</span>+<span class="o">==========================</span>+<span class="o">==========</span>+
<span class="p">|</span> flask                      <span class="p">|</span> <span class="m">0</span>.12.2    <span class="p">|</span> &lt;<span class="m">0</span>.12.3                  <span class="p">|</span> <span class="m">36388</span>    <span class="p">|</span>
<span class="p">|</span> flask                      <span class="p">|</span> <span class="m">0</span>.12.2    <span class="p">|</span> &lt;<span class="m">1</span>.0                     <span class="p">|</span> <span class="m">38654</span>    <span class="p">|</span>
+<span class="o">==============================================================================</span>+
</code></pre></div>


<p>ç°åœ¨ä½ å·²ç»çŸ¥é“äº†å·¥å…·ï¼Œä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯:ä»€ä¹ˆæ—¶å€™åº”è¯¥ä½¿ç”¨å®ƒä»¬ï¼Ÿ</p>
<p>é€šå¸¸ï¼Œè¿™äº›å·¥å…·ä¼šè¿è¡Œ:</p>
<ol>
<li>ç¼–ç æ—¶(åœ¨ideæˆ–ä»£ç ç¼–è¾‘å™¨ä¸­)</li>
<li>æäº¤æ—¶(ä½¿ç”¨é¢„æäº¤æŒ‚é’©)</li>
<li>å½“ä»£ç ç­¾å…¥æºä»£ç ç®¡ç†æ—¶(é€šè¿‡CIç®¡é“)</li>
</ol>
<h3 id="inside-your-ide-or-code-editor">åœ¨æ‚¨çš„ideæˆ–ä»£ç ç¼–è¾‘å™¨ä¸­</h3>
<p>æœ€å¥½å°½æ—©å¹¶ç»å¸¸æ£€æŸ¥å¯èƒ½å¯¹è´¨é‡æœ‰è´Ÿé¢å½±å“çš„é—®é¢˜ã€‚å› æ­¤ï¼Œå¼ºçƒˆå»ºè®®åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯¹ä»£ç è¿›è¡Œlintå’Œæ ¼å¼åŒ–ã€‚è®¸å¤šæµè¡Œçš„ideéƒ½å†…ç½®äº†linterså’Œformattersã€‚ä½ å¯ä»¥ä¸ºä½ çš„ä»£ç ç¼–è¾‘å™¨æ‰¾åˆ°ä¸€ä¸ªæ’ä»¶ï¼Œç”¨äºä¸Šé¢æåˆ°çš„å¤§å¤šæ•°å·¥å…·ã€‚æ­¤ç±»æ’ä»¶ä¼šå®æ—¶è­¦å‘Šæ‚¨ä»£ç é£æ ¼è¿è§„å’Œæ½œåœ¨çš„ç¼–ç¨‹é”™è¯¯ã€‚</p>
<p>èµ„æº:</p>
<ol>
<li><a href="https://code.visualstudio.com/docs/python/linting">æ—æŒº</a>å’Œ<a href="https://code.visualstudio.com/docs/python/editing#_formatting">åœ¨Visual Studioä»£ç ä¸­æ ¼å¼åŒ–</a> Python</li>
<li><a href="https://black.readthedocs.io/en/stable/integrations/editors.html">é»‘è‰²ç¼–è¾‘å™¨é›†æˆ</a></li>
<li><a href="https://packagecontrol.io/">å´‡é«˜æ–‡å­—åŒ…æŸ¥æ‰¾å™¨</a></li>
<li><a href="https://atom.io/packages"> AtomåŒ…</a></li>
</ol>
<h3 id="pre-commit-hooks">æäº¤å‰æŒ‚é’©</h3>
<p>ç”±äºæ‚¨åœ¨ç¼–ç æ—¶ä¸å¯é¿å…åœ°ä¼šé—æ¼ä¸€äº›è­¦å‘Šï¼Œæ‰€ä»¥åœ¨æäº¤æ—¶ç”¨é¢„æäº¤gitæŒ‚é’©æ£€æŸ¥è´¨é‡é—®é¢˜æ˜¯ä¸€ä¸ªå¥½çš„å®è·µã€‚åœ¨lintä¹‹å‰ï¼Œå¯ä»¥å…ˆæ ¼å¼åŒ–ä»£ç ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥é¿å…åœ¨CIç®¡é“ä¸­æäº¤æ— æ³•é€šè¿‡ä»£ç è´¨é‡æ£€æŸ¥çš„ä»£ç ã€‚</p>
<p>æ¨èä½¿ç”¨<a href="https://pre-commit.com/">é¢„æäº¤</a>æ¡†æ¶æ¥ç®¡ç†gitæŒ‚é’©ã€‚</p>


<p>å®‰è£…å®Œæˆåï¼Œæ·»åŠ ä¸€ä¸ªåä¸º<em>çš„é¢„æäº¤é…ç½®æ–‡ä»¶ã€‚å°†pre-commit-config.yaml </em>æäº¤åˆ°é¡¹ç›®ä¸­ã€‚è¦è¿è¡ŒFlake8ï¼Œè¯·æ·»åŠ ä»¥ä¸‹é…ç½®:</p>
<div class="codehilite"><pre><span/><code><span class="nt">repos</span><span class="p">:</span><span class="w"/>
<span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://gitlab.com/PyCQA/flake8</span><span class="w"/>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0.1</span><span class="w"/>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flake8</span><span class="w"/>
</code></pre></div>

<p>æœ€åï¼Œè¦è®¾ç½®gitæŒ‚é’©è„šæœ¬ï¼Œè¿è¡Œ:</p>
<div class="codehilite"><pre><span/><code><span class="o">(</span>venv<span class="o">)</span>$ pre-commit install
</code></pre></div>

<p>ç°åœ¨ï¼Œæ¯æ¬¡è¿è¡Œ<code>git commit</code> Flake8éƒ½ä¼šåœ¨å®é™…æäº¤ä¹‹å‰è¿è¡Œã€‚å¦‚æœæœ‰ä»»ä½•é—®é¢˜ï¼Œæäº¤å°†è¢«ä¸­æ­¢ã€‚</p>
<h3 id="ci-pipeline">CIç®¡é“</h3>
<p>å°½ç®¡æ‚¨å¯èƒ½åœ¨ä»£ç ç¼–è¾‘å™¨å’Œé¢„æäº¤é’©å­ä¸­ä½¿ç”¨ä»£ç è´¨é‡å·¥å…·ï¼Œä½†æ‚¨ä¸èƒ½æ€»æ˜¯æŒ‡æœ›æ‚¨çš„é˜Ÿå‹å’Œå…¶ä»–åˆä½œè€…ä¹Ÿè¿™æ ·åšã€‚å› æ­¤ï¼Œæ‚¨åº”è¯¥åœ¨CIç®¡é“ä¸­è¿è¡Œä»£ç è´¨é‡æ£€æŸ¥ã€‚æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥è¿è¡Œlinterså’Œå®‰å…¨æ¼æ´æ£€æµ‹å™¨ï¼Œå¹¶ç¡®ä¿ä»£ç éµå¾ªç‰¹å®šçš„ä»£ç é£æ ¼ã€‚æ‚¨å¯ä»¥åœ¨æµ‹è¯•çš„åŒæ—¶è¿è¡Œè¿™æ ·çš„æ£€æŸ¥ã€‚</p>
<h2 id="real-project">çœŸå®é¡¹ç›®</h2>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„é¡¹ç›®æ¥çœ‹çœ‹æ‰€æœ‰è¿™äº›æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹:</p>
<div class="codehilite"><pre><span/><code>$ mkdir flask_example
$ <span class="nb">cd</span> flask_example
</code></pre></div>

<p>æ¥ä¸‹æ¥ï¼Œç”¨<a href="https://python-poetry.org">è¯—æ­Œ</a>åˆå§‹åŒ–ä½ çš„é¡¹ç›®:</p>
<div class="codehilite"><pre><span/><code>$ poetry init

Package name <span class="o">[</span>flask_example<span class="o">]</span>:
Version <span class="o">[</span><span class="m">0</span>.1.0<span class="o">]</span>:
Description <span class="o">[]</span>:
Author <span class="o">[</span>Your name &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a1d8ced4d3e1c4ccc0c8cd8fc2cecc">[emailÂ protected]</a>&gt;, n to skip<span class="o">]</span>:
License <span class="o">[]</span>:
Compatible Python versions <span class="o">[</span>^3.10<span class="o">]</span>:

Would you like to define your main dependencies interactively? <span class="o">(</span>yes/no<span class="o">)</span> <span class="o">[</span>yes<span class="o">]</span> no
Would you like to define your development dependencies interactively? <span class="o">(</span>yes/no<span class="o">)</span> <span class="o">[</span>yes<span class="o">]</span> no
Do you confirm generation? <span class="o">(</span>yes/no<span class="o">)</span> <span class="o">[</span>yes<span class="o">]</span>
</code></pre></div>

<p>ä¹‹åï¼Œæ·»åŠ Flaskã€pytestã€Flake8ã€Blackã€isortã€Banditå’ŒSafety:</p>
<div class="codehilite"><pre><span/><code>$ poetry add flask
$ poetry add --dev pytest flake8 black isort safety bandit
</code></pre></div>

<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ¥ä¿å­˜åä¸º<em> test_app.py </em>çš„æµ‹è¯•:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">app</span>
<span class="kn">import</span> <span class="nn">pytest</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">client</span><span class="p">():</span>
    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">'TESTING'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">client</span>


<span class="k">def</span> <span class="nf">test_home</span><span class="p">(</span><span class="n">client</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span>
</code></pre></div>

<p>æ¥ä¸‹æ¥ï¼Œä¸ºFlaskåº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªåä¸º<em> app.py </em>çš„æ–‡ä»¶:</p>
<div class="codehilite"><pre><span/><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">'OK'</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡æ·»åŠ é¢„æäº¤é…ç½®ã€‚</p>
<p>é¦–å…ˆï¼Œåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„gitå­˜å‚¨åº“:</p>


<p>æ¥ä¸‹æ¥ï¼Œå®‰è£…é¢„æäº¤å¹¶è®¾ç½®gitæŒ‚é’©è„šæœ¬:</p>
<div class="codehilite"><pre><span/><code>$ poetry add --dev pre-commit
$ poetry run pre-commit install
</code></pre></div>

<p>ä¸ºåä¸º<em>çš„é…ç½®åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚é¢„æäº¤é…ç½®. yaml </em>:</p>
<div class="codehilite"><pre><span/><code><span class="nt">repos</span><span class="p">:</span><span class="w"/>
<span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">repo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://gitlab.com/PyCQA/flake8</span><span class="w"/>
<span class="w">    </span><span class="nt">rev</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0.1</span><span class="w"/>
<span class="w">    </span><span class="nt">hooks</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w">   </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flake8</span><span class="w"/>
</code></pre></div>

<p>åœ¨æäº¤ä¹‹å‰ï¼Œè¿è¡Œisortå’ŒBlack:</p>
<div class="codehilite"><pre><span/><code>$ poetry run isort . --profile black
$ poetry run black .
</code></pre></div>

<p>æäº¤æ‚¨çš„æ›´æ”¹ä»¥è§¦å‘é¢„æäº¤æŒ‚é’©:</p>
<div class="codehilite"><pre><span/><code>$ git add .
$ git commit -m <span class="s1">'Initial commit'</span>
</code></pre></div>

<p>æœ€åï¼Œè®©æˆ‘ä»¬é€šè¿‡<a href="https://github.com/features/actions"> GitHub Actions </a>é…ç½®ä¸€ä¸ªCIç®¡é“ã€‚</p>
<p>åˆ›å»ºä»¥ä¸‹æ–‡ä»¶å’Œæ–‡ä»¶å¤¹:</p>
<div class="codehilite"><pre><span/><code>.github
â””â”€â”€ workflows
    â””â”€â”€ main.yaml
</code></pre></div>

<p><em>ã€‚github/workflows/main.yaml </em>:</p>
<div class="codehilite"><pre><span/><code><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CI</span><span class="w"/>
<span class="nt">on</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">push</span><span class="p p-Indicator">]</span><span class="w"/>

<span class="nt">jobs</span><span class="p">:</span><span class="w"/>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="nt">strategy</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="nt">fail-fast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"/>
<span class="w">      </span><span class="nt">matrix</span><span class="p">:</span><span class="w"/>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3.10.2</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">        </span><span class="nt">poetry-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.1.13</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ubuntu-latest</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.os }}</span><span class="w"/>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="7e1d161b1d15110b0a3e084d">[emailÂ protected]</a></span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5a293f2e2f2a772a232e3235341a2c68">[emailÂ protected]</a></span><span class="w"/>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"/>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run image</span><span class="w"/>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">abatilo/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8feeecfbe6e0e1fca2ffe0eafbfdf6cff9bda1bfa1bf">[emailÂ protected]</a></span><span class="w"/>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"/>
<span class="w">          </span><span class="nt">poetry-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.poetry-version }}</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry install</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run tests</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run pytest</span><span class="w"/>
<span class="w">  </span><span class="nt">code-quality</span><span class="p">:</span><span class="w"/>
<span class="w">    </span><span class="nt">strategy</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="nt">fail-fast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w"/>
<span class="w">      </span><span class="nt">matrix</span><span class="p">:</span><span class="w"/>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3.10.2</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">        </span><span class="nt">poetry-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.1.13</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ubuntu-latest</span><span class="p p-Indicator">]</span><span class="w"/>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.os }}</span><span class="w"/>
<span class="w">    </span><span class="nt">steps</span><span class="p">:</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="5e3d363b3d35312b2a1e286d">[emailÂ protected]</a></span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b3c0d6c7c6c39ec3cac7dbdcddf3c581">[emailÂ protected]</a></span><span class="w"/>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"/>
<span class="w">          </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run image</span><span class="w"/>
<span class="w">        </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">abatilo/<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="08696b7c6167667b2578676d7c7a71487e3a26382638">[emailÂ protected]</a></span><span class="w"/>
<span class="w">        </span><span class="nt">with</span><span class="p">:</span><span class="w"/>
<span class="w">          </span><span class="nt">poetry-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.poetry-version }}</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry install</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run black</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run black . --check</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run isort</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run isort . --check-only --profile black</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run flake8</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run flake8 .</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run bandit</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run bandit .</span><span class="w"/>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run saftey</span><span class="w"/>
<span class="w">        </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">poetry run safety check</span><span class="w"/>
</code></pre></div>

<p>è¿™ç§é…ç½®:</p>
<ul>
<li>æ¯æ¬¡æ¨é€æ—¶è¿è¡Œ- <code>on: [push]</code></li>
<li>è¿è¡Œåœ¨æœ€æ–°ç‰ˆæœ¬çš„Ubuntu - <code>ubuntu-latest</code></li>
<li>ä½¿ç”¨Python 3.10.2 - <code>python-version: [3.10.2]</code>ï¼Œ<code>python-version: ${{ matrix.python-version }}</code></li>
<li>1.1.13 -ä½¿ç”¨è¯—æ­Œç‰ˆæœ¬<code>poetry-version: [1.1.13]</code>ï¼Œ<code>poetry-version: ${{ matrix.poetry-version }}</code></li>
</ul>
<p>å®šä¹‰äº†ä¸¤ä¸ªä½œä¸š:<code>test</code>å’Œ<code>code-quality</code>ã€‚é¡¾åæ€ä¹‰ï¼Œæµ‹è¯•åœ¨<code>test</code>ä½œä¸šä¸­è¿è¡Œï¼Œè€Œæˆ‘ä»¬çš„ä»£ç è´¨é‡æ£€æŸ¥åœ¨<code>code-quality</code>ä½œä¸šä¸­è¿è¡Œã€‚</p>
<p>å°†é…ç½®é¡¹é…ç½®æ·»åŠ åˆ°gitå¹¶æäº¤:</p>
<div class="codehilite"><pre><span/><code>$ git add .github/workflows/main.yaml
$ git commit -m <span class="s1">'Add CI config'</span>
</code></pre></div>

<p>åœ¨<a href="https://github.com/new"> GitHub </a>ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºåº“ï¼Œå¹¶å°†æ‚¨çš„é¡¹ç›®æ¨é€åˆ°æ–°åˆ›å»ºçš„remoteã€‚</p>
<p>ä¾‹å¦‚:</p>
<div class="codehilite"><pre><span/><code>$ git remote add origin <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="65020c1125020c110d10074b060a08">[emailÂ protected]</a>:jangia/flask_example.git
$ git branch -M main
$ git push -u origin main
</code></pre></div>

<p>æ‚¨åº”è¯¥åœ¨GitHubå­˜å‚¨åº“çš„<em> Actions </em>é€‰é¡¹å¡ä¸Šçœ‹åˆ°æ‚¨çš„å·¥ä½œæµæ­£åœ¨è¿è¡Œã€‚</p>
<h2 id="conclusion">ç»“è®º</h2>
<p>ä»£ç è´¨é‡æ˜¯è½¯ä»¶å¼€å‘ä¸­æœ€å…·äº‰è®®çš„è¯é¢˜ä¹‹ä¸€ã€‚å°¤å…¶æ˜¯ä»£ç é£æ ¼ï¼Œåœ¨å¼€å‘äººå‘˜ä¸­æ˜¯ä¸€ä¸ªæ•æ„Ÿçš„é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬èŠ±è´¹äº†å¤§é‡çš„å¼€å‘æ—¶é—´æ¥é˜…è¯»ä»£ç ã€‚å½“ä»£ç å…·æœ‰ç¬¦åˆPEP-8æ ‡å‡†çš„ä¸€è‡´é£æ ¼æ—¶ï¼Œé˜…è¯»å’Œæ¨æ–­æ„å›¾è¦å®¹æ˜“å¾—å¤šã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¯ç‡¥ã€å¹³å‡¡çš„è¿‡ç¨‹ï¼Œå®ƒåº”è¯¥ç”±è®¡ç®—æœºé€šè¿‡ä»£ç æ ¼å¼åŒ–ç¨‹åºå¦‚Blackå’Œisortæ¥å¤„ç†ã€‚åŒæ ·ï¼ŒFlake8ã€Banditå’ŒSafetyæœ‰åŠ©äºç¡®ä¿æ‚¨çš„ä»£ç å®‰å…¨æ— è¯¯ã€‚</p>
<hr/>

<blockquote>
<p><a href="/guides/complete-python/">å®Œæ•´Python </a>æŒ‡å—:</p>
<ol>
<li><a href="/blog/python-environments/">ç°ä»£Pythonç¯å¢ƒâ€”â€”ä¾èµ–æ€§å’Œå·¥ä½œç©ºé—´ç®¡ç†</a></li>
<li><a href="/blog/testing-python/">Pythonä¸­çš„æµ‹è¯•</a></li>
<li><a href="/blog/modern-tdd/">Pythonä¸­çš„ç°ä»£æµ‹è¯•é©±åŠ¨å¼€å‘</a></li>
<li><a href="/blog/python-code-quality/"> Pythonä»£ç è´¨é‡</a>(æœ¬æ–‡ï¼)</li>
<li><a href="/blog/python-type-checking/"> Pythonç±»å‹æ£€æŸ¥</a></li>
<li><a href="/blog/documenting-python/">è®°å½•Pythonä»£ç å’Œé¡¹ç›®</a></li>
<li><a href="/blog/python-project-workflow/"> Pythoné¡¹ç›®å·¥ä½œæµç¨‹</a></li>
</ol>
</blockquote>
  </div>

  </div>    
</body>
</html>